{"ast":null,"code":"import _asyncToGenerator from\"/Users/hetawk/Documents/CODING_ENV/web/FullStack/Blog/app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/hetawk/Documents/CODING_ENV/web/FullStack/Blog/app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/hetawk/Documents/CODING_ENV/web/FullStack/Blog/app/node_modules/@babel/runtime/regenerator/index.js\";import\"./SinglePost.css\";// import Classmate1 from \"../img/class_mate1.jpeg\";\nimport{Link,useLocation}from\"react-router-dom\";import{useContext,useEffect,useState}from\"react\";import axios from\"axios\";import{Context}from\"../context/Context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SinglePost(){var location=useLocation();var path=location.pathname.split(\"/\")[2];var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var PF=\"http://127.0.0.1:7000/img/\";var _useContext=useContext(Context),user=_useContext.user;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),desc=_useState6[0],setDesc=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),updateMode=_useState8[0],setUpdateMode=_useState8[1];useEffect(function(){var getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/posts/\"+path);case 2:res=_context.sent;setPost(res.data);setTitle(res.data.title);setDesc(res.data.desc);// console.log(res)\ncase 6:case\"end\":return _context.stop();}}},_callee);}));return function getPost(){return _ref.apply(this,arguments);};}();getPost();},[path]);// console.log(location.pathname.split(\"/\")[2])\n// delete function\nvar handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete(\"/posts/ \".concat(post._id),{data:{username:user.username}});case 3:// after deleting go to home page\nwindow.location.replace(\"/\");_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleDelete(){return _ref2.apply(this,arguments);};}();var handleUpdate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.put(\"/posts/ \".concat(post._id),{username:user.username,title:title,desc:desc});case 3:setUpdateMode(false);_context3.next=9;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 9:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function handleUpdate(){return _ref3.apply(this,arguments);};}();// console.log(post.username === user.username)\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"singlepost\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"singlepostWrapper\",children:[post.photo&&/*#__PURE__*/_jsx(\"img\",{className:\"singlepostImg\",src:PF+post.photo//------------//\n,alt:\"\"}),// if user is in updateMode then update the text, if not then excute the curent h1 \nupdateMode?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,className:\"singlepostTitleInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}}):/*#__PURE__*/_jsxs(\"h1\",{className:\"singlepostTitle\",children:[title,post.username===(user===null||user===void 0?void 0:user.username)&&/*#__PURE__*/_jsxs(\"div\",{className:\"singlepostEdit\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"singlepostIcon far fa-edit\",onClick:function onClick(){return setUpdateMode(true);}}),/*#__PURE__*/_jsx(\"i\",{className:\"singlepostIcon far fa-trash-alt\",onClick:handleDelete})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"singlepostInfo\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"singlepostAu\",children:[\"Author:\",/*#__PURE__*/_jsx(Link,{to:\"/?user=\".concat(post.username),className:\"link\",children:/*#__PURE__*/_jsx(\"b\",{children:post.username})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"singlepostDate\",children:new Date(post.createdAt).toDateString()})]}),updateMode?/*#__PURE__*/_jsx(\"textarea\",{className:\"singlepostDescInput\",value:desc,onChange:function onChange(e){return setDesc(e.target.value);}}):/*#__PURE__*/_jsx(\"p\",{className:\"singlepostDesc\",children:desc}),updateMode&&/*#__PURE__*/_jsx(\"button\",{className:\"singlepostButton\",onClick:handleUpdate,children:\"Update\"})]})});}","map":{"version":3,"sources":["/Users/hetawk/Documents/CODING_ENV/web/FullStack/Blog/app/src/Pages/SinglePost.jsx"],"names":["Link","useLocation","useContext","useEffect","useState","axios","Context","SinglePost","location","path","pathname","split","post","setPost","PF","user","title","setTitle","desc","setDesc","updateMode","setUpdateMode","getPost","get","res","data","handleDelete","delete","_id","username","window","replace","console","log","handleUpdate","put","photo","e","target","value","Date","createdAt","toDateString"],"mappings":"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","sourcesContent":["import \"./SinglePost.css\"\n// import Classmate1 from \"../img/class_mate1.jpeg\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport { useContext, useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { Context } from \"../context/Context\";\n\nexport default function SinglePost\n    () {\n    const location = useLocation()\n    const path = location.pathname.split(\"/\")[2];\n\n    const [post, setPost] = useState({});\n    const PF = \"http://127.0.0.1:7000/img/\";\n    const { user } = useContext(Context);\n    const [title, setTitle] = useState(\"\");\n    const [desc, setDesc] = useState(\"\");\n    const [updateMode, setUpdateMode] = useState(false);\n\n\n\n    useEffect(() => {\n        const getPost = async () => {\n            const res = await axios.get(\"/posts/\" + path);\n            setPost(res.data);\n            setTitle(res.data.title);\n            setDesc(res.data.desc);\n            // console.log(res)\n        };\n        getPost();\n    }, [path]);\n    // console.log(location.pathname.split(\"/\")[2])\n\n    // delete function\n    const handleDelete = async () => {\n        try {\n            // delete post using the username and post id attach to it\n            await axios.delete(`/posts/ ${post._id}`, {\n                data: { username: user.username },\n            });\n            // after deleting go to home page\n            window.location.replace(\"/\");\n        } catch (err) {\n            console.log(err)\n        }\n    };\n    const handleUpdate = async () => {\n        try {\n            await axios.put(`/posts/ ${post._id}`, {\n                username: user.username,\n                title,\n                desc,\n            });\n            setUpdateMode(false);\n        } catch (err) {\n            console.log(err)\n        }\n    };\n\n    // console.log(post.username === user.username)\n    return (\n        <div className=\"singlepost\">\n            <div className=\"singlepostWrapper\">\n                {post.photo && (\n                    <img\n                        className=\"singlepostImg\"\n                        src={PF + post.photo}                   //------------//\n                        alt=\"\"\n                    />\n                )}\n                {// if user is in updateMode then update the text, if not then excute the curent h1 \n                    updateMode ? (\n                        <input\n                            type=\"text\"\n                            value={title}\n                            className=\"singlepostTitleInput\"\n                            autoFocus\n                            onChange={(e) => setTitle(e.target.value)}\n                        />\n                    )\n                        : (\n                            <h1 className=\"singlepostTitle\">\n                                {title}\n                                {/* if the post belong to a user, show these edit or delete buttons */}\n                                {post.username === user?.username && (\n                                    <div className=\"singlepostEdit\">\n                                        <i\n                                            className=\"singlepostIcon far fa-edit\"\n                                            onClick={() => setUpdateMode(true)}\n                                        ></i>\n                                        <i\n                                            className=\"singlepostIcon far fa-trash-alt\"\n                                            onClick={handleDelete}\n                                        ></i>\n                                    </div>\n                                )}\n                            </h1>\n\n                        )\n                }\n                <div className=\"singlepostInfo\">\n                    <span className=\"singlepostAu\">\n                        Author:\n                        <Link to={`/?user=${post.username}`} className=\"link\">\n                            <b>{post.username}</b>\n                        </Link>\n                    </span>\n                    <span className=\"singlepostDate\">{new Date(post.createdAt).toDateString()}</span>\n\n                </div>\n                {updateMode ? (\n                    <textarea\n                        className=\"singlepostDescInput\"\n                        value={desc}\n                        onChange={(e) => setDesc(e.target.value)}\n                    />\n                ) : (\n                    <p className=\"singlepostDesc\">\n                        {desc}\n                    </p>\n                )}\n                {/* update post button */}\n                {updateMode && (\n                    <button \n                    className=\"singlepostButton\" \n                    onClick={handleUpdate}>Update\n                    </button>\n                )}\n            </div>\n\n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}